# Smart Lens - æ™ºèƒ½é¢„è§ˆé€é•œåŠŸèƒ½

## åŠŸèƒ½æ¦‚è¿°

Smart Lens æ˜¯ä¸€ä¸ª"éç ´åæ€§äº¤äº’"åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·åœ¨ä¸æ‰“æ–­å½“å‰æµè§ˆæµçš„æƒ…å†µä¸‹ï¼Œå³æ—¶é¢„è§ˆé“¾æ¥å†…å®¹ã€‚çµæ„Ÿæ¥è‡ª macOS çš„ Quick Look å’Œ Arc Browser çš„ Peek åŠŸèƒ½ã€‚

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 1. åˆ†å±‚è§¦å‘æœºåˆ¶ (Layered Trigger System)

**L1: è§†è§‰æš—ç¤º (Visual Cue)**
- é¼ æ ‡æ‚¬åœåœ¨å¯é¢„è§ˆé“¾æ¥ä¸Šæ—¶ï¼Œæ˜¾ç¤ºå¾®å¦™çš„è§†è§‰æç¤º
- é“¾æ¥ä¸‹åˆ’çº¿å˜ä¸ºè™šçº¿æ ·å¼
- å¯é€‰æ‹©æ˜¾ç¤º/éšè—å°å›¾æ ‡æç¤º

**L2: æ„å›¾è§¦å‘ (Intent Trigger)**
æä¾›ä¸‰ç§è§¦å‘æ¨¡å¼ï¼š

1. **Space é”®æ¨¡å¼ (æ¨è)**
   - æ‚¬åœé“¾æ¥ + æŒ‰ä¸‹ Space é”®
   - ç±»ä¼¼ macOS Quick Look çš„äº¤äº’ä¹ æƒ¯
   - å®Œå…¨æœç»è¯¯è§¦

2. **è‡ªåŠ¨æ‚¬åœæ¨¡å¼**
   - é¼ æ ‡æ‚¬åœ 1.5 ç§’åè‡ªåŠ¨æ˜¾ç¤º
   - å¸¦æœ‰è¿›åº¦æŒ‡ç¤º
   - é€‚åˆè½»é‡çº§é¢„è§ˆ

3. **Shift æ‚¬åœæ¨¡å¼**
   - æ‚¬åœé“¾æ¥ + æŒ‰ä½ Shift é”®
   - æ›´ç²¾ç¡®çš„æ§åˆ¶

### 2. æ™ºèƒ½å¡ç‰‡å®¹å™¨ (Smart Card Container)

**è§†è§‰ç‰¹æ€§**
- ç£¨ç ‚ç»ç’ƒæ•ˆæœ (Glassmorphism)
- æ™ºèƒ½å®šä½ç®—æ³•ï¼Œæ°¸ä¸é®æŒ¡æ­£åœ¨é˜…è¯»çš„å†…å®¹
- éª¨æ¶å±åŠ è½½åŠ¨ç”»
- æ”¯æŒæ·±è‰²æ¨¡å¼

**å¡ç‰‡ç»“æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: ç½‘ç«™å›¾æ ‡ + åç§° + å…ƒæ•°æ®        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ Body: åŠ¨æ€å†…å®¹åŒºåŸŸ                    â”‚
â”‚ - å°é¢å›¾/ç¼©ç•¥å›¾                       â”‚
â”‚ - æ ‡é¢˜                               â”‚
â”‚ - æè¿°/æ‘˜è¦                          â”‚
â”‚ - AI ç”Ÿæˆçš„ 3 è¡Œæ‘˜è¦                  â”‚
â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Footer: å¿«æ·æ“ä½œ                     â”‚
â”‚ [æ‰“å¼€] [å¤åˆ¶] [AIæ‘˜è¦] [é’‰ä½]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. åœºæ™¯åŒ–å†…å®¹ç­–ç•¥

æ”¯æŒçš„å†…å®¹ç±»å‹ï¼š

#### æ–‡ç«  (Article)
- å°é¢å›¾ (Open Graph Image)
- AI ç”Ÿæˆçš„ 3 è¡Œæ‘˜è¦
- ä½œè€…å’Œå‘å¸ƒæ—¥æœŸ
- é¢„è®¡é˜…è¯»æ—¶é—´

#### è§†é¢‘ (Video)
- è§†é¢‘ç¼©ç•¥å›¾
- æ—¶é•¿ä¿¡æ¯
- ç‰¹æ®Šæ”¯æŒï¼šYouTube (ç›´æ¥æ˜¾ç¤ºé«˜æ¸…ç¼©ç•¥å›¾)

#### ä»£ç ä»“åº“ (Code - GitHub)
- Star æ•°é‡
- ä¸»è¦ç¼–ç¨‹è¯­è¨€
- README ç®€ä»‹
- æœ€åæ›´æ–°æ—¶é—´

#### é€šç”¨ç½‘é¡µ (Generic)
- Open Graph å…ƒæ•°æ®
- ç½‘ç«™ favicon
- æ ‡é¢˜å’Œæè¿°

## æŠ€æœ¯å®ç°

### æ¶æ„ç»„ä»¶

```
src/
â”œâ”€â”€ config/settings/smartLens.ts          # é…ç½®å’Œç±»å‹å®šä¹‰
â”œâ”€â”€ components/
â”‚   â””â”€â”€ SmartLens/
â”‚       â”œâ”€â”€ VisualCue.tsx                 # L1 è§†è§‰æš—ç¤ºå±‚
â”‚       â””â”€â”€ PreviewCard.tsx               # æ™ºèƒ½å¡ç‰‡UI
â”œâ”€â”€ lib/smartLens/
â”‚   â””â”€â”€ contentFetcher.ts                 # Open Graph è§£æå™¨
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ content/smart-lens/
â”‚   â”‚   â””â”€â”€ index.tsx                     # ä¸» Content Script
â”‚   â””â”€â”€ background/smart-lens/
â”‚       â””â”€â”€ fetchPreview.ts               # Background å¤„ç†å™¨
â””â”€â”€ components/Settings/Sections/
    â””â”€â”€ SmartLensSettings.tsx             # è®¾ç½®ç•Œé¢
```

### å…³é”®æŠ€æœ¯ç‚¹

1. **CORS å¤„ç†**
   - é€šè¿‡ Background Service Worker æŠ“å–ç½‘é¡µå†…å®¹
   - é¿å…è·¨åŸŸé™åˆ¶

2. **æ™ºèƒ½å®šä½ç®—æ³•**
   ```typescript
   // è‡ªåŠ¨æ£€æµ‹å¯ç”¨ç©ºé—´ï¼Œé¿å…é®æŒ¡å†…å®¹
   - ä¼˜å…ˆæ˜¾ç¤ºåœ¨é“¾æ¥å³ä¾§
   - ç©ºé—´ä¸è¶³æ—¶è‡ªåŠ¨ç¿»è½¬åˆ°å·¦ä¾§/ä¸Šæ–¹
   - ç¡®ä¿å§‹ç»ˆåœ¨è§†å£å†…
   ```

3. **é’‰ä½æ¨¡å¼ (Pin Mode)**
   - ç‚¹å‡»é’‰å­å›¾æ ‡å›ºå®šå¡ç‰‡
   - å¡ç‰‡å›ºå®šåœ¨å±å¹•è§’è½
   - å¯ä»¥è¾¹çœ‹é¢„è§ˆè¾¹æµè§ˆä¸»é¡µé¢

4. **AI æ‘˜è¦é›†æˆ**
   - ä½¿ç”¨ç°æœ‰çš„ OpenAI API é…ç½®
   - è‡ªåŠ¨ç”Ÿæˆ 3 è¡Œç²¾ç®€æ‘˜è¦
   - å¯é€‰å¯ç”¨/ç¦ç”¨

## ä½¿ç”¨æ–¹å¼

### åŸºç¡€ç”¨æ³•

1. **å¯ç”¨åŠŸèƒ½**
   - æ‰“å¼€æ‰©å±•è®¾ç½®
   - æ‰¾åˆ°"æ™ºèƒ½é¢„è§ˆé€é•œ (Smart Lens)"éƒ¨åˆ†
   - å‹¾é€‰"å¯ç”¨ Smart Lens"

2. **è§¦å‘é¢„è§ˆ**
   - æ–¹å¼ 1 (æ¨è): é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Š + æŒ‰ Space é”®
   - æ–¹å¼ 2: é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šå¹¶ç­‰å¾… 1.5 ç§’
   - æ–¹å¼ 3: é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Š + æŒ‰ä½ Shift é”®

3. **äº¤äº’æ“ä½œ**
   - ç‚¹å‡»"æ‰“å¼€"æŒ‰é’®ï¼šåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥
   - ç‚¹å‡»"å¤åˆ¶"æŒ‰é’®ï¼šå¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿
   - ç‚¹å‡»ğŸ“Œå›¾æ ‡ï¼šå°†é¢„è§ˆå¡ç‰‡é’‰åœ¨å±å¹•è§’è½
   - ç‚¹å‡»Ã—å…³é—­é¢„è§ˆ

### é«˜çº§é…ç½®

#### æ’é™¤ç‰¹å®šç½‘ç«™
```
åœ¨è®¾ç½®ä¸­çš„"æ’é™¤åŸŸå"æ–‡æœ¬æ¡†ä¸­ï¼Œæ¯è¡Œè¾“å…¥ä¸€ä¸ªåŸŸåï¼š
example.com
localhost
192.168.*
```

#### è°ƒæ•´æ‚¬åœå»¶è¿Ÿ
- é€‚ç”¨äº"è‡ªåŠ¨æ‚¬åœ"æ¨¡å¼
- èŒƒå›´ï¼š500ms - 5000ms
- æ¨èï¼š1500ms (1.5ç§’)

#### AI æ‘˜è¦
- éœ€è¦é…ç½® OpenAI API Key
- ä¼šæ¶ˆè€—é¢å¤–çš„ API è°ƒç”¨
- æ‘˜è¦è´¨é‡å–å†³äºåŸæ–‡å†…å®¹é•¿åº¦

## æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨éª¨æ¶å±é¿å…"å†…å®¹è·³å˜"
- æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼ˆTODO: æœªæ¥ç‰ˆæœ¬ï¼‰
- æ‡’åŠ è½½å›¾ç‰‡
- é˜²æŠ–å¤„ç†é¿å…é¢‘ç¹è§¦å‘

## æµè§ˆå™¨å…¼å®¹æ€§

- âœ… Chrome 90+
- âœ… Edge 90+
- âœ… å…¶ä»–åŸºäº Chromium çš„æµè§ˆå™¨

## å·²çŸ¥é™åˆ¶

1. **X-Frame-Options é™åˆ¶**
   - æŸäº›ç½‘ç«™ç¦æ­¢è¢«åµŒå…¥ï¼Œæ— æ³•é¢„è§ˆå®Œæ•´é¡µé¢
   - è§£å†³æ–¹æ¡ˆï¼šä»…æ˜¾ç¤º Open Graph å…ƒæ•°æ®

2. **éœ€è¦ç½‘ç«™æ”¯æŒ Open Graph**
   - æœ€ä½³ä½“éªŒéœ€è¦ç½‘ç«™æä¾›å®Œæ•´çš„ OG æ ‡ç­¾
   - éƒ¨åˆ†ç®€é™‹ç½‘ç«™å¯èƒ½ä¿¡æ¯ä¸å…¨

3. **åŠ¨æ€åŠ è½½çš„å†…å®¹**
   - SPA åº”ç”¨çš„åŠ¨æ€å†…å®¹å¯èƒ½æ— æ³•æŠ“å–
   - è§£å†³æ–¹æ¡ˆï¼šä¾èµ–é™æ€çš„ meta æ ‡ç­¾

## æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šå†…å®¹ç±»å‹ï¼ˆäº§å“ã€è‚¡ç¥¨ã€å¤©æ°”ï¼‰
- [ ] å®ä½“è¯†åˆ«ï¼ˆé€‰ä¸­æ–‡æœ¬ä¹Ÿèƒ½é¢„è§ˆï¼‰
- [ ] é¢„è§ˆå†å²è®°å½•
- [ ] æ™ºèƒ½æ¨èç›¸å…³é“¾æ¥
- [ ] æµ®çª—æ¨¡å¼ (Morphing Animation)
- [ ] é¢„è§ˆå†…å®¹ç¼“å­˜æœºåˆ¶

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°çš„å†…å®¹ç±»å‹

1. åœ¨ `smartLens.ts` ä¸­æ·»åŠ æ–°çš„ typeï¼š
```typescript
export interface LinkPreviewData {
  type: 'article' | 'video' | 'code' | 'product' | 'your-new-type'
  // ...
}
```

2. åœ¨ `contentFetcher.ts` ä¸­æ·»åŠ æ£€æµ‹å’Œè§£æé€»è¾‘ï¼š
```typescript
const detectType = (url: string): LinkPreviewData['type'] => {
  if (url.includes('your-domain.com')) {
    return 'your-new-type'
  }
  // ...
}
```

3. åœ¨ `PreviewCard.tsx` ä¸­æ·»åŠ æ¸²æŸ“é€»è¾‘ï¼š
```typescript
const PreviewContent = ({ data }) => {
  if (data.type === 'your-new-type') {
    return <YourCustomRenderer />
  }
  // ...
}
```

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹ Content Script æ—¥å¿—**
   ```
   F12 â†’ Console â†’ è¿‡æ»¤ "Smart Lens"
   ```

2. **æŸ¥çœ‹ Background Script æ—¥å¿—**
   ```
   chrome://extensions/ â†’ æ‰©å±•è¯¦æƒ… â†’ æ£€æŸ¥è§†å›¾: Service Worker
   ```

3. **æµ‹è¯•ä¸åŒç½‘ç«™**
   ```typescript
   // åœ¨ Console ä¸­å¿«é€Ÿæµ‹è¯•
   chrome.runtime.sendMessage({
     action: 'smart-lens-fetch-preview',
     url: 'https://example.com'
   })
   ```

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ PR æ”¹è¿› Smart Lensï¼

é‡ç‚¹æ”¹è¿›æ–¹å‘ï¼š
- ğŸ¨ æ›´å¤šå†…å®¹ç±»å‹æ”¯æŒ
- âš¡ æ€§èƒ½ä¼˜åŒ–
- ğŸ¯ æ›´å¥½çš„å®šä½ç®—æ³•
- ğŸŒ æ›´å¥½çš„å›½é™…åŒ–æ”¯æŒ

---

**è®¾è®¡çµæ„Ÿ**: macOS Quick Look, Arc Browser Peek, Safari Link Preview
**å®ç°æ—¥æœŸ**: 2025-12-03
